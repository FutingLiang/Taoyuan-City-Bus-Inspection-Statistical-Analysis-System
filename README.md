# 🚌 桃園公車稽查統計分析系統

## 📊 專案簡介
這是一個專為桃園市公車稽查資料設計的網頁分析工具，提供直觀的圖表視覺化和統計分析功能，幫助相關人員快速了解公車營運狀況和違規情形。

## ✨ 功能特色
- 📂 **Excel 檔案上傳** - 支援 .xlsx/.xls 格式，自動解析稽查資料
- 📈 **多元圖表展示** - 長條圖、甜甜圈圖、雷達圖等多種視覺化方式
- 📋 **詳細統計分析** - 客運公司、區域分布、違規項目統計
- 🔍 **違規明細表格** - 完整的違規記錄查詢功能
- 📊 **報告匯出功能** - 一鍵匯出 Excel 分析報告
- 📱 **響應式設計** - 支援桌面、平板、手機等各種裝置
- 🎨 **現代化 UI** - 美觀的漸層設計和流暢的動畫效果

## 🛠 技術棧
- **前端框架**: 純 HTML5 + CSS3 + JavaScript (ES6+)
- **圖表庫**: Chart.js v4.4.0 + DataLabels Plugin
- **Excel 處理**: SheetJS (xlsx) v0.18.5
- **圖示庫**: Font Awesome v6.4.0
- **部署平台**: Vercel
- **版本控制**: GitHub

## 📁 專案結構
```
taoyuan-bus-analysis/
├── index.html          # 主頁面 - 系統入口
├── styles.css          # 樣式檔案 - UI 設計和動畫
├── script.js           # 功能邏輯 - 資料處理和圖表生成
└── README.md           # 專案說明文件
```

## 🚀 快速開始

### 線上使用
直接訪問部署的網站：[你的 Vercel 網址]

### 本地開發
1. **克隆專案**
   ```bash
   git clone https://github.com/你的用戶名/Taoyuan-City-Bus-Inspection-Statistical-Analysis-System.git
   cd Taoyuan-City-Bus-Inspection-Statistical-Analysis-System
   ```

2. **啟動本地服務器**
   ```bash
   # 使用 Python 3
   python -m http.server 8000
   
   # 或使用 Node.js
   npx serve .
   
   # 或使用 Live Server (VS Code 擴展)
   ```

3. **開啟瀏覽器**
   訪問 `http://localhost:8000`

## 📋 使用說明

### 1. 上傳資料
- 點擊「選擇Excel檔案」按鈕
- 選擇包含稽查資料的 .xlsx 或 .xls 檔案
- 系統會自動解析並顯示統計結果

### 2. 查看分析
- **統計卡片**: 總稽查次數、客運公司數量、區域分布、違規率
- **客運公司圖表**: 各公司稽查次數長條圖
- **區域分布圖**: 各行政區稽查比例甜甜圈圖
- **違規項目圖**: 主要違規類型橫向長條圖
- **安全設備圖**: 設備檢查結果雷達圖

### 3. 匯出報告
- 點擊「匯出分析報告」按鈕
- 自動生成包含統計摘要和違規明細的 Excel 檔案

## 📊 資料格式要求

Excel 檔案應包含以下欄位：
- **編號**: 稽查記錄編號
- **日期**: 稽查日期
- **路線**: 公車路線
- **公司/客運公司**: 營運業者名稱
- **車牌**: 車輛牌照號碼
- **駕駛**: 駕駛員姓名
- **區域**: 稽查區域
- **A2 路線圖**: 路線圖張貼狀況 (0=未張貼, 1=已張貼)
- **A3 意見箱**: 意見箱設置狀況 (0=無, 1=有)
- **B4 吸菸**: 駕駛吸菸違規 (0=正常, 1=違規)
- **C1-C13**: 各項營運違規檢查項目
- **D1-D5**: 逃生設備檢查項目
- **E1-E4**: 滅火器檢查項目
- **F1**: 座椅安全檢查

## 🎨 UI 特色

### 視覺設計
- **漸層背景**: 現代化的紫藍色漸層設計
- **卡片式佈局**: 清晰的資訊層次結構
- **圖示整合**: Font Awesome 圖示提升視覺體驗
- **動畫效果**: 流暢的 hover 和載入動畫

### 圖表優化
- **資料標籤**: 直接在圖表上顯示數值
- **互動提示**: 滑鼠懸停顯示詳細資訊
- **色彩協調**: 統一的色彩主題
- **響應式圖表**: 自適應不同螢幕尺寸

## 🔧 自定義設定

### 修改顏色主題
在 `styles.css` 中調整 CSS 變數：
```css
:root {
  --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --accent-color: #667eea;
  --text-color: #2c3e50;
}
```

### 調整圖表配置
在 `script.js` 中修改 `colorPalettes` 物件來自定義圖表顏色。

## 🚀 部署說明

### Vercel 部署 (推薦)
1. 將程式碼推送到 GitHub
2. 在 [Vercel](https://vercel.com) 連接 GitHub 倉庫
3. 選擇專案並點擊 Deploy
4. 每次推送到 main 分支會自動重新部署

### 其他部署選項
- **GitHub Pages**: 適合靜態網站託管
- **Netlify**: 類似 Vercel 的現代化部署平台
- **傳統主機**: 上傳到支援靜態檔案的網頁主機

## 🔄 更新流程

### 自動更新 (推薦)
1. 在 GitHub 上直接編輯檔案
2. 提交變更 (Commit changes)
3. Vercel 自動重新部署 (約 1-2 分鐘)

### 本地更新
```bash
# 修改檔案後
git add .
git commit -m "更新說明"
git push origin main
```

## 🐛 常見問題

### Q: 上傳檔案後沒有反應？
A: 請確認 Excel 檔案包含「編號」欄位，且資料格式正確。

### Q: 圖表顯示異常？
A: 檢查瀏覽器是否支援 ES6+ 語法，建議使用 Chrome、Firefox、Safari 最新版本。

### Q: 匯出功能無法使用？
A: 確認瀏覽器允許下載檔案，部分瀏覽器可能會阻擋自動下載。

## 📈 未來規劃
- [ ] 新增資料篩選功能
- [ ] 支援多檔案批次處理
- [ ] 新增時間趨勢分析
- [ ] 整合地圖視覺化
- [ ] 新增使用者權限管理

## 🤝 貢獻指南
歡迎提交 Issue 和 Pull Request 來改善這個專案！

## 📄 授權條款
MIT License - 詳見 LICENSE 檔案
